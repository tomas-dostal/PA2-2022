# This is @copy of example semester work available on https://gitlab.fit.cvut.cz/bernhdav/pa2-bomb-tag/tree/1.1.0
# @author David Bernhauer <bernhdav@fit.cvut.cz>

TARGET = tspaint

CXX = g++
MKDIR = mkdir -p

CXXFLAGS = -Wall -pedantic -Wextra -std=c++17

SOURCE_DIR = src
BUILD_DIR = build

SOURCES = $(wildcard $(SOURCE_DIR)/*.cpp)
HEADERS = $(wildcard $(SOURCE_DIR)/*.h)

OBJECTS = $(SOURCES:$(SOURCE_DIR)/%.cpp=$(BUILD_DIR)/%.o)


.PHONY: all
all: compile doc
	@echo "Done..."


.PHONY: compile
compile: $(TARGET)
	@echo "Compile..."


.PHONY: run
run: $(TARGET)
	./$(TARGET)


$(TARGET): $(OBJECTS)
	$(CXX) $^ -o $@


$(BUILD_DIR)/%.o: $(SOURCE_DIR)/%.cpp
	$(MKDIR) $(BUILD_DIR)
	$(CXX) $(CXXFLAGS) $< -c -o $@


doc: Doxyfile README.md $(HEADERS)
	doxygen Doxyfile

EXAMPLES = $(wildcard examples/*)
$(TARGET).zip: README.md zadani.txt prohlaseni.txt Makefile Doxyfile $(HEADERS) $(SOURCES) $(EXAMPLES)
	mkdir -p .archive/$(TARGET)/
	cp -r README.md zadani.txt prohlaseni.txt Makefile Doxyfile src/ examples/ .archive/$(TARGET)/
	cd .archive/; zip -r ../$(TARGET).zip $(TARGET)/
	rm -r .archive/

.PHONY: clean
clean:
	rm -rf $(TARGET) $(TARGET).zip doc/ .archive/ $(BUILD_DIR)/ 2>/dev/null


# Dependencies
# Generated by "g++ -MM src/*.cpp | sed -r 's|^(.*\.o)|build/\1|'"
build/Application.o: src/Application.cpp src/Application.h src/Interface.h \
  src/Color.h src/Pos.h src/Formatter.h src/FormatterParams.h \
  src/Command.h src/Tspaint.h src/ColorPalette.h src/CommandParameters.h \
  src/messages.h src/CommandImpl.h
build/Circle.o: src/Circle.cpp src/Circle.h src/Shape.h src/Pos.h src/Color.h \
  src/Interface.h src/Formatter.h src/FormatterParams.h
build/Color.o: src/Color.cpp src/Color.h
build/ColorPalette.o: src/ColorPalette.cpp src/ColorPalette.h src/Color.h
build/Command.o: src/Command.cpp src/Command.h src/Tspaint.h src/ColorPalette.h \
  src/Color.h src/Interface.h src/Pos.h src/Formatter.h \
  src/FormatterParams.h src/Application.h src/CommandParameters.h \
  src/messages.h src/CommandImpl.h
build/CommandImpl.o: src/CommandImpl.cpp src/CommandImpl.h src/messages.h \
  src/FormatterParams.h src/Command.h src/Tspaint.h src/ColorPalette.h \
  src/Color.h src/Interface.h src/Pos.h src/Formatter.h \
  src/Application.h src/CommandParameters.h
build/CommandParameters.o: src/CommandParameters.cpp src/CommandParameters.h
build/Formatter.o: src/Formatter.cpp src/Formatter.h src/FormatterParams.h
build/FormatterParams.o: src/FormatterParams.cpp src/FormatterParams.h
build/Helper.o: src/Helper.cpp src/Helper.h
build/Interface.o: src/Interface.cpp src/Interface.h src/Color.h src/Pos.h \
  src/Formatter.h src/FormatterParams.h src/Helper.h src/ColorPalette.h \
  src/messages.h
build/Line.o: src/Line.cpp src/Line.h src/Shape.h src/Pos.h src/Color.h \
  src/Interface.h src/Formatter.h src/FormatterParams.h
build/Polyline.o: src/Polyline.cpp src/Polyline.h src/Shape.h src/Pos.h \
  src/Color.h src/Interface.h src/Formatter.h src/FormatterParams.h \
  src/Line.h
build/Pos.o: src/Pos.cpp src/Pos.h
build/Rectangle.o: src/Rectangle.cpp src/Rectangle.h src/Polyline.h src/Shape.h \
  src/Pos.h src/Color.h src/Interface.h src/Formatter.h \
  src/FormatterParams.h src/Line.h
build/Shape.o: src/Shape.cpp src/Shape.h src/Pos.h src/Color.h src/Interface.h \
  src/Formatter.h src/FormatterParams.h
build/Tspaint.o: src/Tspaint.cpp src/Tspaint.h src/ColorPalette.h src/Color.h
build/main.o: src/main.cpp src/Application.h src/Interface.h src/Color.h \
  src/Pos.h src/Formatter.h src/FormatterParams.h src/Command.h \
  src/Tspaint.h src/ColorPalette.h src/CommandParameters.h \
  src/messages.h src/CommandImpl.h
