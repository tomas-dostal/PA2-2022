# This is @copy of example semester work available on https://gitlab.fit.cvut.cz/bernhdav/pa2-bomb-tag/tree/1.1.0
# @author David Bernhauer <bernhdav@fit.cvut.cz>
# @basedon https://gitlab.fit.cvut.cz/bernhdav/pa2-bomb-tag/tree/1.1.0
# @modified by Tomas Dostal <dostato6@fit.cvut.cz>

TARGET = dostato6	# Name of the executable to be created

CXX = g++
MKDIR = mkdir -p

# -g is debug flag
CXXFLAGS = -Wall -pedantic -Wextra -std=c++17 -g

SOURCE_DIR = src
BUILD_DIR = build

SOURCES = $(wildcard $(SOURCE_DIR)/*.cpp)
HEADERS = $(wildcard $(SOURCE_DIR)/*.h)

OBJECTS = $(SOURCES:$(SOURCE_DIR)/%.cpp=$(BUILD_DIR)/%.o)


.PHONY: all
all: compile doc
	@echo "Done..."


.PHONY: compile
compile: $(TARGET)
	@echo "Compile..."


# Target for running the compiled program
.PHONY: run
run: $(TARGET)
	./$(TARGET)

# Rule for linking the object files into the executable
# $^ is all the dependencies of the current target.
# All the object files that need to be linked together.
# -o specifies the output file name.
# $@ target (the file being generated) in a makefile.
$(TARGET): $(OBJECTS)
	$(CXX) $^ -o $@

# Rule for compiling each source file into an object file
$(BUILD_DIR)/%.o: $(SOURCE_DIR)/%.cpp
	$(MKDIR) $(BUILD_DIR)
	$(CXX) $(CXXFLAGS) $< -c -o $@


doc: Doxyfile README.md $(HEADERS)
	doxygen Doxyfile

EXAMPLES = $(wildcard examples/*)
zip: README.md zadani.txt prohlaseni.txt Makefile Doxyfile $(HEADERS) $(SOURCES) $(EXAMPLES)
	mkdir -p .archive/$(TARGET)/
	cp -r README.md zadani.txt prohlaseni.txt Makefile Doxyfile src/ examples/ .archive/$(TARGET)/
	cd .archive/; zip -r ../$(TARGET).zip $(TARGET)/
	rm -r .archive/

.PHONY: clean
clean:
	rm -rf $(TARGET) $(TARGET).zip doc/ .archive/ $(BUILD_DIR)/ 2>/dev/null


# Dependencies
# Generated by "g++ -MM src/*.cpp | sed -r 's|^(.*\.o)|build/\1|'"
build/Application.o: src/Application.cpp src/Application.h src/Interface.h \
  src/Color.h src/Pixel.h src/Pos.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Command.h src/Tspaint.h \
  src/SuperShape.h src/Export.h src/ShapeGroup.h src/messages.h \
  src/CommandImpl.h src/SysCommand.h src/ProgtestErrors.h \
  src/constants.h
build/Circle.o: src/Circle.cpp src/Circle.h src/Shape.h src/SuperShape.h \
  src/Pos.h src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h src/messages.h
build/Color.o: src/Color.cpp src/Color.h src/Pixel.h
build/ColorPalette.o: src/ColorPalette.cpp src/ColorPalette.h src/Color.h \
  src/Pixel.h
build/Command.o: src/Command.cpp src/Command.h src/Tspaint.h src/SuperShape.h \
  src/Pos.h src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h src/ShapeGroup.h
build/CommandImpl.o: src/CommandImpl.cpp src/Helper.h src/CommandImpl.h \
  src/FormatterParams.h src/Command.h src/Tspaint.h src/SuperShape.h \
  src/Pos.h src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/ColorPalette.h src/Export.h src/ShapeGroup.h src/SysCommand.h \
  src/messages.h src/constants.h src/ExportSVG.h src/ExportTspaint.h \
  src/Circle.h src/Shape.h src/Line.h src/Rectangle.h src/PolyLine.h \
  src/Ellipse.h src/ExportBMP.h
build/Ellipse.o: src/Ellipse.cpp src/Ellipse.h src/Shape.h src/SuperShape.h \
  src/Pos.h src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h src/messages.h
build/Export.o: src/Export.cpp src/Export.h src/SuperShape.h src/Pos.h \
  src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/messages.h
build/ExportBMP.o: src/ExportBMP.cpp src/ExportBMP.h src/Export.h \
  src/SuperShape.h src/Pos.h src/Interface.h src/Color.h src/Pixel.h \
  src/Formatter.h src/FormatterParams.h src/ColorPalette.h \
  src/messages.h src/constants.h
build/ExportSVG.o: src/ExportSVG.cpp src/ExportSVG.h src/Export.h \
  src/SuperShape.h src/Pos.h src/Interface.h src/Color.h src/Pixel.h \
  src/Formatter.h src/FormatterParams.h src/ColorPalette.h \
  src/messages.h
build/ExportTspaint.o: src/ExportTspaint.cpp src/ExportTspaint.h src/Export.h \
  src/SuperShape.h src/Pos.h src/Interface.h src/Color.h src/Pixel.h \
  src/Formatter.h src/FormatterParams.h src/ColorPalette.h \
  src/messages.h
build/Formatter.o: src/Formatter.cpp src/Formatter.h src/FormatterParams.h \
  src/Color.h src/Pixel.h src/ColorPalette.h src/Pos.h src/messages.h
build/FormatterParams.o: src/FormatterParams.cpp src/FormatterParams.h
build/Helper.o: src/Helper.cpp src/Helper.h
build/Interface.o: src/Interface.cpp src/Interface.h src/Color.h src/Pixel.h \
  src/Pos.h src/Formatter.h src/FormatterParams.h src/ColorPalette.h \
  src/Helper.h src/constants.h src/messages.h
build/Line.o: src/Line.cpp src/Line.h src/Shape.h src/SuperShape.h src/Pos.h \
  src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h src/messages.h
build/PolyLine.o: src/PolyLine.cpp src/PolyLine.h src/Shape.h src/SuperShape.h \
  src/Pos.h src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h src/Line.h \
  src/Helper.h src/messages.h
build/Pos.o: src/Pos.cpp src/Pos.h
build/ProgtestErrors.o: src/ProgtestErrors.cpp src/ProgtestErrors.h \
  src/Interface.h src/Color.h src/Pixel.h src/Pos.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/messages.h
build/Rectangle.o: src/Rectangle.cpp src/Rectangle.h src/Shape.h \
  src/SuperShape.h src/Pos.h src/Interface.h src/Color.h src/Pixel.h \
  src/Formatter.h src/FormatterParams.h src/ColorPalette.h src/Export.h \
  src/messages.h
build/Shape.o: src/Shape.cpp src/Shape.h src/SuperShape.h src/Pos.h \
  src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h
build/ShapeGroup.o: src/ShapeGroup.cpp src/ShapeGroup.h src/SuperShape.h \
  src/Pos.h src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h src/Helper.h \
  src/messages.h
build/SuperShape.o: src/SuperShape.cpp src/SuperShape.h src/Pos.h \
  src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h
build/SysCommand.o: src/SysCommand.cpp src/SysCommand.h src/Command.h \
  src/Tspaint.h src/SuperShape.h src/Pos.h src/Interface.h src/Color.h \
  src/Pixel.h src/Formatter.h src/FormatterParams.h src/ColorPalette.h \
  src/Export.h src/ShapeGroup.h
build/Tspaint.o: src/Tspaint.cpp src/Tspaint.h src/SuperShape.h src/Pos.h \
  src/Interface.h src/Color.h src/Pixel.h src/Formatter.h \
  src/FormatterParams.h src/ColorPalette.h src/Export.h src/ShapeGroup.h \
  src/constants.h src/messages.h
build/main.o: src/main.cpp src/Application.h src/Interface.h src/Color.h \
  src/Pixel.h src/Pos.h src/Formatter.h src/FormatterParams.h \
  src/ColorPalette.h src/Command.h src/Tspaint.h src/SuperShape.h \
  src/Export.h src/ShapeGroup.h src/messages.h src/CommandImpl.h \
  src/SysCommand.h src/ProgtestErrors.h
